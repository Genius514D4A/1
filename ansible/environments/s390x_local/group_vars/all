whisk_version_name: local
config_root_dir: /tmp/wskconf
whisk_logs_dir: /tmp/wsklogs
docker_registry: ""
docker_dns: ""

db_prefix: "{{ ansible_user_id|lower }}_{{ ansible_hostname|lower }}_"

# Auto lookup to find the db credentials
db_provider: "{{ lookup('ini', 'db_provider section=db_creds file={{ playbook_dir }}/db_local.ini') }}"
db_username: "{{ lookup('ini', 'db_username section=db_creds file={{ playbook_dir }}/db_local.ini') }}"
db_password: "{{ lookup('ini', 'db_password section=db_creds file={{ playbook_dir }}/db_local.ini') }}"
db_protocol: "{{ lookup('ini', 'db_protocol section=db_creds file={{ playbook_dir }}/db_local.ini') }}"
db_host: "{{ lookup('ini', 'db_host section=db_creds file={{ playbook_dir }}/db_local.ini') }}"
db_port: "{{ lookup('ini', 'db_port section=db_creds file={{ playbook_dir }}/db_local.ini') }}"

# API GW connection configuration
apigw_auth_user: ""
apigw_auth_pwd: ""
apigw_host_v2: "http://{{ groups['apigateway']|first }}:{{apigateway.port.api}}/v2"

controller_arguments: '-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.port=1098'
invoker_arguments: "{{ controller_arguments }}"

invoker_allow_multiple_instances: true

# Set kafka configuration
kafka_heap: '512m'
kafka_topics_completed_retentionBytes: 104857600
kafka_topics_completed_retentionMS: 300000
kafka_topics_health_retentionBytes: 104857600
kafka_topics_health_retentionMS: 300000
kafka_topics_invoker_retentionBytes: 104857600
kafka_topics_invoker_retentionMS: 300000

# RunC enablement
invoker_use_runc: true
invoker_use_reactive_pool: false

### S390X - validate that it's needed ###

# Docker images to pull for S390X docker

# TODO:  Set up defaults for the affected roles so these
#        serve as overrides.  Consider moving other settings
#        from ${ANSIBLE_HOME}/group_vars/all to those
#        defaults.

couchdb:
    docker_image: "jpspring/s390x-openwhisk:couchdb"

kafka:
    docker_image: "docker.xanophis.com/s390x/wurstmeister-kafka:0.11"

apigateway:
    docker_image: "jpspring/s390x-openwhisk:apigateway"

#  Because we don't (yet) support s390x compiles of the CLI; a different challenge...
cli_installation_mode: local
